<h2>
  Time now: {{todayDate | date: 'mediumTime'}}
</h2>
<a name="" id="" class="btn btn-primary m-2" [routerLink]="['/NewProduct']" role="button">Add Product</a>
<hr>

<div class="store-info my-3">
  <h3>{{ StoreInfo.name }}</h3>
  <img [src]="StoreInfo.imgURL" alt="Store Logo" class="store-logo" />
  <div>
    <strong>Branches:</strong>
    <ul>
      <li *ngFor="let branch of StoreInfo.branches">{{ branch }}</li>
    </ul>
  </div>
</div>

<!-- Dropdown for Categories -->
<div class="form-group">
  <label for="categorySelect">Select Category:</label>
  <select id="categorySelect" class="form-control" [(ngModel)]="selectedCategoryID" (change)="filterProductsByCategory()">
    <option value="">Select a category</option> <!-- Optional: Default option -->
    <option *ngFor="let cat of categories" [value]="cat.id">{{ cat.name }}</option>
  </select>
</div>




<!-- Input for Client Name -->
<div class="form-group">
  <label for="clientName">Enter Your Name:</label>
  <input type="text" id="clientName" class="form-control" [(ngModel)]="ClientName" placeholder="Your Name">
</div>

<!-- Buy Button -->
<button class="btn btn-success my-2" (click)="togglePurchase()">Buy</button>

<!-- ng-template for Thank You Message -->
<ng-template #purchaseTemplate>
  <div class="alert alert-success my-3">
    Thanks for purchasing from our store, {{ ClientName }}!
  </div>
</ng-template>
  
<table class="table my-3" *ngIf="!isPurchased; else purchaseTemplate">
  <thead class="bg-dark text-light">
    <tr>
      <th scope="col">#</th>
      <th scope="col">Name</th>
      <th scope="col">Image</th>
      <th scope="col">Price in USD</th>
      <th scope="col">Price in EGP</th>
      <th scope="col">Quantity</th>
      <th scope="col">Details</th>
      <th scope="col">Items count</th>
      <th scope="col">Add to Cart</th>
    </tr>
  </thead>
  <tbody>
    <ng-container *ngFor="let prd of filteredProductList; let i = index; trackBy: productsTrackBy">
      <tr [ngStyle]="{'background-color': prd.quantity == 0 ? 'lightyellow' : 'lightgray', 'color': prd.quantity == 0 ? 'red' : 'darkblue'}">
        <td>{{ i + 1 }}</td>
        <td>{{ prd.name }}</td>
        <td><img LightBox="yellow" defaultColor="white" [src]="prd.imgURL" alt="Product Image"></td>
        <td>{{ prd.price | currency: 'USD' : 'code' }}</td>
        <td>{{ prd.price | USDtoEGP:20 | currency: 'EGP' }}</td>
        <td>
          <ng-container [ngSwitch]="prd.quantity">
            <div *ngSwitchCase="0">Out of Stock</div>
            <div *ngSwitchCase="1">Last Item</div>
            <div *ngSwitchCase="2">Last 2 items</div>
            <div *ngSwitchDefault>{{ prd.quantity }}</div>
          </ng-container>
        </td>
        <td><a class="btn btn-primary" role="button" [routerLink]="['/Products', prd.id]">Details</a></td>
        <td><input #itemsCount type="number" class="form-control" min="1" max="{{ prd.quantity }}" [disabled]="prd.quantity === 0"></td>
        <td><button type="button" class="btn btn-secondary" (click)="updateOrderTotalPrice(+itemsCount.value, prd.price)">Add to cart</button></td>
      </tr>
    </ng-container>
  </tbody>
</table>


<div class="bg-danger">
  <h3>[For Test] To be removed:
    <br>
    Total price in nested component: {{orderTotalPrice}}
  </h3>
</div>
